#!/usr/bin/env node
var app = require('../app');

var TelegramBot = require('node-telegram-bot-api');

var token = '251610071:AAH6_YDkEhLiiK5JI4jeGvqjRf1gmf7UZwA';

var bot = new TelegramBot(token, { polling: true });

// Matches "/echo [whatever]"
bot.onText(/\/echo (.+)/, function (msg, match) {
  // 'msg' is the received Message from Telegram
  // 'match' is the result of executing the regexp above on the text content
  // of the message

  var chatId = msg.chat.id;
  var resp = match[1]; // the captured "whatever"


  bot.sendMessage(chatId, resp);
});


bot.on('message', function (msg) {
  var chatId = msg.chat.id;

  bot.sendMessage(chatId, "Received your message");
});

app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  console.log('Express server listening on port ' + server.address().port);
});
